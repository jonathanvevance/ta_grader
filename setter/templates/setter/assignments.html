{% extends 'setter/base.html' %}

{% block css_content %}
{% load static %}
<link rel="stylesheet" href="{% static 'setter/assignments.css' %}">
{% endblock css_content %}

{% block content %}
<div class="row">

    <!------------------------------------------------- SIDEBAR ----------------------------------------------------->
    <!--------------------------------------------------------------------------------------------------------------->

    <div class="col-sm-4 bg-dark text-light text-center" id="sidebar">
        {% for assignment in all_assignments %}
        <a href="{% url 'setter:assignment-id' assignment.id %}" class="lead text-primary nav-link text-start px-0">
            <span class="ms-1 {% if this_assignment == assignment %}border-bottom{% endif %}">
                {{ assignment.title }}</span>
        </a>
        {% endfor %}

        <!-- {% for i in '0123412412221141'|make_list %}
        <a href="#" class="lead nav-link text-start px-0">
            <span class="ms-1">Hello there</span>
        </a>
        {% endfor %} -->
    </div>

    <div id="sidebar-buttons" class="bg-dark">
        <a href="#" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#add-assignment">
            <span class="ms-1">Add Assignment</span>
        </a>
        <a href="#" class="btn btn-danger {% if this_assignment == None %} disabled {% endif %}" data-bs-toggle="modal"
            data-bs-target="#delete-assignment"> <span class=" ms-1">Delete Assignment</span>
        </a>
    </div>

    <!-- Add assignment modal -->
    <div class="modal fade" id="add-assignment" tabindex="-1" aria-labelledby="add-assignment-label" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="add-assignment-label">Add Assignment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form role="form" method="POST" action="{% url 'setter:add-assignment' %}">
                        {% csrf_token %}
                        <div class="form-group mb-3">
                            <label class="control-label">Enter name of the assignment</label>
                            <div>
                                <input type="text" class="form-control input-lg" name="assignment-name" value="">
                            </div>
                        </div>
                        <div class="mt-3 text-end">
                            <button type="hutton" class="btn btn-secondary float-right"
                                data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">Add assignment</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete assignment Modal -->
    <div class="modal fade" role="dialog" id="delete-assignment" tabindex="-1" aria-labelledby="delete-assignment-label"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="delete-assignment-label">Delete Assignment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">Are you sure you want to delete '{{ this_assignment.title }}' </div>
                <div class="modal-footer">
                    <button type="hutton" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <a href="{% if this_assignment != None %} {% url 'setter:delete-assignment' this_assignment.id %} {% else%} # {% endif %}"
                        class="btn btn-danger button">Delete Assignment</a>
                </div>
            </div>
        </div>
    </div>

</div>

<!------------------------------------------------- CONTENT ----------------------------------------------------->
<!--------------------------------------------------------------------------------------------------------------->
<!-- TODO: question with tagline and description separate. -->
<!-- TODO: show description only in modal. -->
<div class="col-sm-4" id="questions">
    {% for question in questions %}
    <div class="card mt-3 mx-2">
        <div class="card-body">
            <h5 class="card-title">{{ question.title }}<a class="question-link stretched-link" href="#"
                    data-bs-toggle="modal" data-bs-target="#question-modal-{{ question.id }}"></a></h5>
            <p class="card-text">{{ question.description|safe }}</p>
        </div>
    </div>

    <div class="modal fade" id="question-modal-{{ question.id }}" tabindex="-1"
        aria-labelledby="question-modal-{{ question.id }}-label" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="question-modal-{{ question.id }}-label">{{ question.title }}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">{{ question.description|safe }}</div>
                <div class="modal-footer">
                    <a href="{% url 'setter:edit-question' question.id %}" class="btn btn-primary button">Edit
                        Question</a>
                    <a href="{% url 'setter:delete-question' question.id %}" class="btn btn-danger button">Delete
                        Question</a>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<a href="{% if this_assignment != None %}{% url 'setter:add-question' this_assignment.id %}{% else %}#{% endif %}"
    name="add-question" class="btn float-btn {% if this_assignment == None %}disabled{% endif %}">
    <i class="bi bi-plus-circle-fill tooltip-test" title="Add question"></i>
</a>

</div>
{% endblock content %}